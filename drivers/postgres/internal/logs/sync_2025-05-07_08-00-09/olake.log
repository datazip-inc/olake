{"level":"info","time":"2025-05-07T08:00:09Z","message":"System has 16GB RAM, setting iceberg writer batch size to 419430400 bytes"}
{"level":"info","message":"Standard Replication is selected","time":"2025-05-07T08:00:09Z"}
{"level":"info","message":"Standard Replication is selected","time":"2025-05-07T08:00:09Z"}
{"level":"info","message":"Standard Replication is selected","time":"2025-05-07T08:00:09Z"}
{"level":"info","time":"2025-05-07T08:00:10Z","message":"Starting discover for Postgres database postgres"}
{"level":"info","message":"Standard Replication is selected","time":"2025-05-07T08:00:10Z"}
{"level":"info","time":"2025-05-07T08:00:10Z","message":"Iceberg JAR file found in base directory: /Users/dukedhal/Desktop/olake/debezium-server-iceberg-sink.jar"}
{"level":"info","time":"2025-05-07T08:00:10Z","message":"Connected to new iceberg writer on port 50051 for stream check_01JTMW4RC1SS7BKEV3EX0HGYAE, configHash check_01JTMW4RC1SS7BKEV3EX0HGYAE-check-false"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:11.960 [main] INFO  io.debezium.server.iceberg.OlakeRpcServer - Logs will be output to console only","time":"2025-05-07T08:00:11Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:12.051 [main] INFO  org.apache.iceberg.CatalogUtil - Loading custom FileIO implementation: org.apache.iceberg.io.ResolvingFileIO","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:12.411 [main] INFO  io.debezium.serde.json.JsonSerdeConfig - JsonSerdeConfig values: ","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tfrom.field = null","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tunknown.properties.ignored = false","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] ","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:12.412 [main] INFO  io.debezium.serde.json.JsonSerdeConfig - JsonSerdeConfig values: ","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tfrom.field = null","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] \tunknown.properties.ignored = false","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] ","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:12.770 [main] INFO  io.debezium.server.iceberg.OlakeRpcServer - Server started on port 50051 with max message size: 2000MB","time":"2025-05-07T08:00:12Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:13.411 [grpc-default-executor-0] INFO  io.debezium.server.iceberg.rpc.OlakeRowsIngester - [Thread-23-284546331724500] Parsing messages took: 72 ms","time":"2025-05-07T08:00:13Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:13.440 [grpc-default-executor-0] INFO  org.apache.iceberg.BaseMetastoreTableOperations - Refreshing table metadata from new version: s3a://warehouse/olake_iceberg/olake_test_table_duke/metadata/00002-efdb47b5-df47-47d5-be53-40cf68ca9dff.metadata.json","time":"2025-05-07T08:00:13Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:13.442 [grpc-default-executor-0] INFO  org.apache.iceberg.CatalogUtil - Loading custom FileIO implementation: org.apache.iceberg.aws.s3.S3FileIO","time":"2025-05-07T08:00:13Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:14.362 [grpc-default-executor-0] INFO  org.apache.iceberg.BaseMetastoreCatalog - Table loaded by catalog: olake_iceberg.olake_iceberg.olake_test_table_duke","time":"2025-05-07T08:00:14Z"}
{"level":"info","message":"[Java-Iceberg:50051] 13:30:14.364 [grpc-default-executor-0] INFO  io.debezium.server.iceberg.tableoperator.IcebergTableOperator - Batch got 1 records with 1 different schema!!","time":"2025-05-07T08:00:14Z"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] 13:30:14.440 [grpc-default-executor-0] ERROR io.debezium.server.iceberg.rpc.OlakeRowsIngester - [Thread-23-284546331724500] Failed to process table events for table: olake_test_table_duke"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] java.lang.IllegalArgumentException: Cannot change column type: _olake_timestamp: long -> timestamptz"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.relocated.com.google.common.base.Preconditions.checkArgument(Preconditions.java:464) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.SchemaUpdate.updateColumn(SchemaUpdate.java:287) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.updateColumn(UnionByNameVisitor.java:175) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.lambda$struct$0(UnionByNameVisitor.java:98) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.stream.Streams$RangeIntSpliterator.forEachRemaining(Streams.java:104) ~[?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.stream.IntPipeline$Head.forEach(IntPipeline.java:617) ~[?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.struct(UnionByNameVisitor.java:87) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.struct(UnionByNameVisitor.java:33) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.SchemaWithPartnerVisitor.visit(SchemaWithPartnerVisitor.java:68) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.SchemaWithPartnerVisitor.visit(SchemaWithPartnerVisitor.java:45) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.visit(UnionByNameVisitor.java:70) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.SchemaUpdate.unionByNameWith(SchemaUpdate.java:373) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.applyFieldAddition(IcebergTableOperator.java:154) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.addToTable(IcebergTableOperator.java:197) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.OlakeRowsIngester.sendRecords(OlakeRowsIngester.java:97) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.RecordIngestServiceGrpc$MethodHandlers.invoke(RecordIngestServiceGrpc.java:232) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:356) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) [?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.lang.Thread.run(Thread.java:842) [?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] 13:30:14.442 [grpc-default-executor-0] ERROR io.debezium.server.iceberg.rpc.OlakeRowsIngester - [Thread-23-284546331724500] Failed to process request: Cannot change column type: _olake_timestamp: long -> timestamptz"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] java.lang.IllegalArgumentException: Cannot change column type: _olake_timestamp: long -> timestamptz"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.relocated.com.google.common.base.Preconditions.checkArgument(Preconditions.java:464) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.SchemaUpdate.updateColumn(SchemaUpdate.java:287) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.updateColumn(UnionByNameVisitor.java:175) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.lambda$struct$0(UnionByNameVisitor.java:98) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.stream.Streams$RangeIntSpliterator.forEachRemaining(Streams.java:104) ~[?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.stream.IntPipeline$Head.forEach(IntPipeline.java:617) ~[?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.struct(UnionByNameVisitor.java:87) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.struct(UnionByNameVisitor.java:33) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.SchemaWithPartnerVisitor.visit(SchemaWithPartnerVisitor.java:68) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.SchemaWithPartnerVisitor.visit(SchemaWithPartnerVisitor.java:45) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.schema.UnionByNameVisitor.visit(UnionByNameVisitor.java:70) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat org.apache.iceberg.SchemaUpdate.unionByNameWith(SchemaUpdate.java:373) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.applyFieldAddition(IcebergTableOperator.java:154) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.tableoperator.IcebergTableOperator.addToTable(IcebergTableOperator.java:197) ~[debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.OlakeRowsIngester.sendRecords(OlakeRowsIngester.java:97) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.debezium.server.iceberg.rpc.RecordIngestServiceGrpc$MethodHandlers.invoke(RecordIngestServiceGrpc.java:232) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:356) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) [debezium-server-iceberg-sink.jar:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) [?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]"}
{"level":"error","time":"2025-05-07T08:00:14Z","message":"[Java-Iceberg:50051] \tat java.base/java.lang.Thread.run(Thread.java:842) [?:?]"}
{"level":"info","time":"2025-05-07T08:00:14Z","message":"Shutting down Iceberg server on port 50051"}
